openapi: 3.0.1
info:
  title: APIRecintos
  description: API para prestação de informações sobre eventos de controle aduaneiro
    a cargo dos Redex, Recintos, Administradores e Operadores Aeroportuários, Portuários
    e demais intervenientes em carga sobre controle aduaneiro.
  version: "1.0b"
servers:
- url: /
paths:
  /auth:
    post:
      summary: retorna token JWT
      operationId: authentication.generate_token
      requestBody:
        description: Terminal e senha
        content:
          application/json:
            schema:
              x-body-name: recinto
              $ref: '#/components/schemas/AuthenticationJson'
      responses:
        '200':
          description: JWT token
          content:
            'text/plain':
              schema:
                type: string
  /secret:
    get:
      summary: Return secret string
      operationId: authentication.get_secret
      responses:
        '200':
          description: secret response
          content:
            'text/plain':
              schema:
                type: string
      security:
      - jwt: ['secret']
  /eventos/filter:
    post:
      operationId: api.filter_eventos
      requestBody:
        description: Lista de eventos que correspondam ao filtro
        content:
          application/json:
            schema:
              x-body-name: filtro
              $ref: '#/components/schemas/FiltroEvento'
        required: true
      responses:
        200:
          description: Evento Base
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArrayEventoBase'
        400:
          description: Erro
          content: {}
        404:
          description: Eventos não encontrados para filtro atual.
          content: {}
        default:
          description: Erro inesperado
          content: {}
  /eventosnovos/list:
    post:
      operationId: api.get_eventosnovos
      requestBody:
        description: Lista de eventos maiores que um ID ou Data
        content:
          application/json:
            schema:
              x-body-name: filtro
              $ref: '#/components/schemas/FiltroNovoEvento'
        required: true
      responses:
        200:
          description: Evento Base
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArrayEventoBase'
        400:
          description: Erro
          content: {}
        404:
          description: Eventos não encontrados para filtro atual.
          content: {}
        default:
          description: Erro inesperado
          content: {}
  /acessoveiculo:
    post:
      operationId: api.acessoveiculo
      requestBody:
        description: Controle de passagem em ponto de controle / entrada e saida de
          veiculos em area
        content:
          application/json:
            schema:
              x-body-name: evento
              $ref: '#/components/schemas/AcessoVeiculo'
        required: true
      responses:
        201:
          description: Evento incluido
          content: {}
        400:
          description: Entrada invalida - erro nos campos ou na validacao
          content: {}
        409:
          description: Evento repetido ou outro erro de integridade
          content: {}
  /acessoveiculo/{IDEvento}:
    get:
      operationId: api.get_acessoveiculo
      parameters:
      - name: IDEvento
        in: path
        description: ID do Evento no Sistema original
        required: true
        schema:
          type: integer
      responses:
        200:
          description: Evento Base
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AcessoVeiculo'
        400:
          description: ID inválido
          content: {}
        404:
          description: Evento com ID não encontrado para recinto atual.
          content: {}
        default:
          description: Erro inesperado
          content: {}
  /pesagemveiculocarga:
    post:
      operationId: api.pesagemveiculocarga
      requestBody:
        description: Controle de pesagem no modal maritimo
        content:
          application/json:
            schema:
              x-body-name: evento
              $ref: '#/components/schemas/PesagemVeiculoCarga'
        required: true
      responses:
        201:
          description: Evento incluido
          content: {}
        400:
          description: Entrada invalida - erro nos campos ou na validacao
          content: {}
        409:
          description: Evento repetido ou outro erro de integridade
          content: {}
  /pesagemveiculocarga/{IDEvento}:
    get:
      operationId: api.get_pesagemveiculocarga
      parameters:
      - name: IDEvento
        in: path
        description: ID do Evento no Sistema original
        required: true
        schema:
          type: integer
      responses:
        200:
          description: Evento Base
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PesagemVeiculoCarga'
        400:
          description: ID inválido
          content: {}
        404:
          description: Evento com ID não encontrado para recinto atual.
          content: {}
        default:
          description: Erro inesperado
          content: {}
  /inspecaonaoinvasiva:
    post:
      operationId: api.inspecaonaoinvasiva
      requestBody:
        description: Controle de inspecoes nao invasiva - recepcao de imagens
        content:
          application/json:
            schema:
              x-body-name: evento
              $ref: '#/components/schemas/InspecaonaoInvasiva'
        required: true
      responses:
        201:
          description: Evento incluido
          content: {}
        400:
          description: Entrada invalida - erro nos campos ou na validacao
          content: {}
        409:
          description: Evento repetido ou outro erro de integridade
          content: {}
  /inspecaonaoinvasiva/{IDEvento}:
    get:
      operationId: api.get_inspecaonaoinvasiva
      parameters:
      - name: IDEvento
        in: path
        description: ID do Evento no Sistema original
        required: true
        schema:
          type: integer
      responses:
        200:
          description: Evento Base
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InspecaonaoInvasiva'
        400:
          description: ID inválido
          content: {}
        404:
          description: Evento com ID não encontrado para recinto atual.
          content: {}
        default:
          description: Erro inesperado
          content: {}
components:
  securitySchemes:
    jwt:
      type: http
      scheme: bearer
      bearerFormat: JWT
      x-bearerInfoFunc: authentication.decode_token
  schemas:
    AuthenticationJson:
      type: object
      properties:
        recinto:
          type: string
        senha:
          type: string
    EntradaSaida:
      type: string
      description: Operação de entrada ou de saída de carga
      enum:
      - Entrada
      - Saida
    Autoridade:
      type: string
      description: Sigla da autoridade
      enum:
      - RFB
      - MAPA
      - ACI
      - ANVISA
      - IBAMA
      - PF
      - JUSTICA
    TipoDocumentoTransporte:
      type: string
      description: Sigla que identifica o tipo de documento de transporte que ampara a entrada ou saida da carga
      enum:
      - CE
      - NFE
      - DUE
      - DA
      - DTA
      - DI
    TipoDeclaracaoAduaneira:
      type: string
      description: Sigla que identifica o tipo de declaracao
      enum:
      - DUE
      - DA
      - DTA
      - DI
    TipoDocumentoDesconsolidacao:
      type: string
      description: Sigla que identifica o tipo de documento que ampara a desunitizacao
      enum:
      - CE
    TipoDocumentoPapel:
      type: string
      description: Sigla que identifica o tipo de documento do agente ou transportador que ampara a desunitizacao
      enum:
      - BL
      - AWB
    TipoModal:
      type: string
      description: Sigla do modal
      enum:
      - Ferroviario
      - Rodoviario
      - Aereo
      - Maritimo
    RespostaPadrao:
      type: object
      properties:
        title:
          type: string
        detail:
          type: string
          description: Mensagem de erro ou hash do evento transmitido
        status:
          type: integer
          description: HTTP Status code
    Anexos:
      type: object
      properties:
        nomearquivo:
          type: string
        datacriacao:
          type: string
          description: Data e Hora da criacao do arquivo
          format: date-time
        datamodificacao:
          type: string
          description: Data e Hora da ultima modificacao do arquivo
          format: date-time
        contentType:
          type: string
        content:
          type: string
    Evento:
      type: object
      properties:
        dtHrTransmissao:
          type: string
          description: Data da recepção do Evento pela API
          format: date-time
        codRecinto:
          type: string
        cnpjTransmissor:
          type: string
        ip:
          type: string
        hash:
          type: string
        idEvento:
          type: string
        dtHrOcorrencia:
          type: string
          description: Data de ocorrência física do evento
          format: date-time
        dtHrRegistro:
          type: string
          description: Data do registro do Evento no Sistema original
          format: date-time
        cpfOperOcor:
          description: CPF do Operador que realizou o evento fisicamente
          type: string
        cpfOperReg:
          description: CPF do Operador que registrou o evento no Sistema
          type: string
        retificador:
          description: Retifica evento anteriormente transmitido
          type: boolean
        idEventoRetif:
          type: string
        contingencia:
          type: boolean
    AcessoVeiculo:
      allOf:
      - $ref: '#/components/schemas/Evento'
      - type: object
        properties:
          tipooperacao:
            $ref: '#/components/schemas/EntradaSaida'
          IDAgendamento:
            type: integer
            description: ID do Agendamento desta operação, se houver
          IDGate:
            type: string
            description: Identificador do Portao de ocorrencia do Evento
          documentotransporte:
            type: string
            description: Numero do conteiner
          tipodocumentotransporte:
            $ref: '#/components/schemas/TipoDocumentoTransporte'
          placa:
            type: string
            description: Placa Cavalo-trator/truck/automóvel
          dimensaoespecial:
            type: boolean
            description: Dimensoes que impecam entrada comum ou escaneamento(OOG)
          pesoespecial:
            type: boolean
            description: Peso que impeca entrada comum ou escaneamento(OOG)
          listanfe:
            type: array
            items:
              type: object
              properties:
                chavenfe:
                  type: string
          reboques:
            type: array
            items:
              type: object
              properties:
                placa:
                  type: string
                vazio:
                  type: boolean
                lacres:
                  type: string
                lacressif:
                  type: string
                localsif:
                  type: string
                cnpjestadia:
                  type: string
                nomeestadia:
                  type: string
                lacresverificados:
                  type: string
                lacressifverificados:
                  type: string
                avarias:
                  type: string
          conteineres:
            type: array
            items:
              type: object
              properties:
                numero:
                  type: string
                vazio:
                  type: boolean
                lacres:
                  type: string
                lacressif:
                  type: string
                localsif:
                  type: string
                portodescarga:
                  type: string
                paisdestino:
                  type: string
                  description: Pais destino da carga
                navioembarque:
                  type: string
                cpfcnpjcliente:
                  type: string
                nomecliente:
                  type: string
                numerobooking:
                  type: string
                lacresverificados:
                  type: string
                lacressifverificados:
                  type: string
                avarias:
                  type: string
          cpfcnpjtransportador:
            type: string
            description: CPF ou CNPJ do Transportador responsável
          nometransportador:
            type: string
            description: Nome do Transportador responsável
          cpfmotorista:
            type: string
            description: CPF do Motorista
          nomemotorista:
            type: string
            description: Nome do Motorista
          modal:
            $ref: '#/components/schemas/TipoModal'
          ocr:
            type: boolean
            description: Captura automática de placa (OCR)
          dataliberacao:
            type: string
            description: Data e hora da comunicação de liberação da carga pelo recinto
              (apenas na saída)
            format: date-time
    PesagemVeiculoCarga:
      allOf:
      - $ref: '#/components/schemas/Evento'
      - type: object
        properties:
          documentotransporte:
            type: string
            description: Numero do documento que embasa o Transporte
          tipodocumentotransporte:
            $ref: '#/components/schemas/TipoDocumentoTransporte'
          numero:
            type: string
            description: Numero do conteiner maritimo ou do ULD aereo
          placa:
            type: string
            description: Placa do caminhao/truck/cavalo
          placasemireboque:
            type: string
            description: Placa semireboque em caso de carregamento
          pesobrutodeclarado:
            type: integer
            description: Peso bruto declarado nos documentos de transporte em kg
          taraconjunto:
            type: integer
            description: Peso do conjunto cavalo-carreta retirado da balanca e cadastrado no Recinto
          pesobalanca:
            type: integer
            description: Peso do conjunto cavalo-carreta-carga retirado da balanca
          capturaautomatica:
            type: boolean
            description: Captura realizada automaticamente pela balanca, sem intervencao manual ou digitacao
    PesagemTerrestre:
      allOf:
      - $ref: '#/components/schemas/Evento'
      - type: object
        properties:
          documentotransporte:
            type: string
            description: Numero do conteiner
          tipodocumentotransporte:
            $ref: '#/components/schemas/TipoDocumentoTransporte'
          pesobrutodeclarado:
            type: integer
            description: Peso bruto declarado nos documentos de transporte em kg
          placa:
            type: string
            description: Placa do caminhao/truck/cavalo
          tara:
            type: integer
            description: Tara do caminhao/truck/cavalo
          reboques:
            type: array
            items:
              type: object
              properties:
                placa:
                  type: string
                tara:
                  type: integer
          conteineres:
            type: array
            items:
              type: object
              properties:
                numero:
                  type: string
                tara:
                  type: integer
          pesobalanca:
            type: integer
            description: Peso do conjunto cavalo-carreta-carga retirado da balanca
          capturaautomatica:
            type: boolean
            description: Captura realizada automaticamente pela balanca, sem intervencao manual ou digitacao
    InspecaonaoInvasiva:
      allOf:
      - $ref: '#/components/schemas/Evento'
      - type: object
        properties:
          listaManifestos:
            type: array
            items:
              type: object
              properties:
                num:
                  type: string
                  description: Numero do documento de transporte
                tipo:
                  $ref: '#/components/schemas/TipoDocumentoTransporte'
          listaCarga:
            type: array
            items:
              type: string
          listaSemirreboque:
            type: array
            items:
              type: object
              properties:
                placa:
                  type: string
                  description: Placa do semireboque
                ocrPlaca:
                  type: boolean
          listaConteineresUld:
            type: array
            items:
              type: object
              properties:
                num:
                  type: string
                  description: Numero do conteiner
                ocrNum:
                  type: boolean
          placa:
            type: string
            description: Placa do caminhao/truck/cavalo
          ocrPlaca:
            type: boolean
            description: Captura realizada automaticamente pelo OCR, sem intervencao manual ou digitacao
          anexos:
            type: array
            description: Outros arquivos (XML, JSON, imagens, etc) gerados pelo equipamento
            items:
              $ref: '#/components/schemas/Anexos'
          imgScanner:
            type: object
            properties:
              dtHrScaneamento:
                type: string
              dtHrModifArquivo:
                type: string
              nmArquivo:
                type: string
              coordenadasAlerta:
                type: object
                properties:
                  x:
                    type: integer
                  y:
                    type: integer
                  x2:
                    type: integer
                  y2:
                    type: integer
              img:
                type: string
          idScanner:
            type: integer
          idCamera:
            type: integer
    FiltroNovoEvento:
      type: object
      properties:
        IDEvento:
          type: integer
          description: IDEvento a partir do qual pesquisar (maior que) OU
        recinto:
          type: string
          description: Codigo do Recinto a pesquisar
        tipoevento:
          type: string
          description: Nome da classe de Evento
        datainicial:
          type: string
          description: Data de ocorrência física do evento - inicio de pesquisa
          format: date-time
        datafinal:
          type: string
          description: Data de ocorrência física do evento - final de pesquisa
          format: date-time
    FiltroEvento:
      type: object
      properties:
        recinto:
          type: string
          description: Codigo do Recinto a pesquisar
        tipoevento:
          type: string
          description: Nome da classe de Evento
        datainicial:
          type: string
          description: Data de ocorrência física do evento - inicio de pesquisa
          format: date-time
        datafinal:
          type: string
          description: Data de ocorrência física do evento - final de pesquisa
          format: date-time
    ArrayEventoBase:
      type: array
      items:
        $ref: '#/components/schemas/Evento'
